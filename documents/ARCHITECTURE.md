# ğŸ—ï¸ Arquitectura del Sistema EduGo

## VisiÃ³n General

EduGo es una plataforma educativa basada en **microservicios** que utiliza una arquitectura **event-driven** para procesar materiales educativos con IA y generar assessments automÃ¡ticos.

---

## ğŸ“ Diagrama de Arquitectura Completo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    CAPA DE PRESENTACIÃ“N                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚   â”‚     ğŸ“± Mobile App     â”‚              â”‚   ğŸ–¥ï¸ Admin Panel      â”‚                        â”‚
â”‚   â”‚   (React Native/      â”‚              â”‚   (React/NextJS)     â”‚                        â”‚
â”‚   â”‚    Flutter)           â”‚              â”‚                      â”‚                        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚              â”‚                                     â”‚                                     â”‚
â”‚              â”‚ HTTPS/REST                          â”‚ HTTPS/REST                          â”‚
â”‚              â–¼                                     â–¼                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    CAPA DE API                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚        ğŸ”µ api-mobile             â”‚    â”‚    ğŸŸ¢ api-administracion        â”‚            â”‚
â”‚   â”‚                                  â”‚    â”‚                                 â”‚            â”‚
â”‚   â”‚  Endpoints:                      â”‚    â”‚  Endpoints:                     â”‚            â”‚
â”‚   â”‚  â€¢ /auth/* (login, register)     â”‚    â”‚  â€¢ /schools/* (CRUD)            â”‚            â”‚
â”‚   â”‚  â€¢ /materials/* (upload, list)   â”‚    â”‚  â€¢ /users/* (gestiÃ³n)           â”‚            â”‚
â”‚   â”‚  â€¢ /assessments/* (take, submit) â”‚    â”‚  â€¢ /academic-units/* (CRUD)     â”‚            â”‚
â”‚   â”‚  â€¢ /progress/* (tracking)        â”‚    â”‚  â€¢ /reports/* (estadÃ­sticas)    â”‚            â”‚
â”‚   â”‚                                  â”‚    â”‚  â€¢ /memberships/* (matrÃ­culas)  â”‚            â”‚
â”‚   â”‚  Roles: student, teacher         â”‚    â”‚  Roles: admin, coordinator      â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚              â”‚                                       â”‚                                   â”‚
â”‚              â”‚ Publish events                        â”‚ Publish events                    â”‚
â”‚              â–¼                                       â–¼                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                CAPA DE MENSAJERÃA                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚                        â”‚        ğŸ° RabbitMQ               â”‚                              â”‚
â”‚                        â”‚                                  â”‚                              â”‚
â”‚                        â”‚  Exchanges:                      â”‚                              â”‚
â”‚                        â”‚  â€¢ edugo.materials (topic)       â”‚                              â”‚
â”‚                        â”‚  â€¢ edugo.assessments (topic)     â”‚                              â”‚
â”‚                        â”‚  â€¢ edugo.students (topic)        â”‚                              â”‚
â”‚                        â”‚                                  â”‚                              â”‚
â”‚                        â”‚  Queues:                         â”‚                              â”‚
â”‚                        â”‚  â€¢ worker.materials.process      â”‚                              â”‚
â”‚                        â”‚  â€¢ worker.assessments.generate   â”‚                              â”‚
â”‚                        â”‚  â€¢ notifications.push            â”‚                              â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                   â”‚                                                      â”‚
â”‚                                   â”‚ Consume events                                       â”‚
â”‚                                   â–¼                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              CAPA DE PROCESAMIENTO                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚                        â”‚        ğŸ¤– Worker                 â”‚                              â”‚
â”‚                        â”‚                                  â”‚                              â”‚
â”‚                        â”‚  Tareas:                         â”‚                              â”‚
â”‚                        â”‚  â€¢ Extraer texto de PDFs         â”‚                              â”‚
â”‚                        â”‚  â€¢ Generar resÃºmenes con IA      â”‚                              â”‚
â”‚                        â”‚  â€¢ Generar assessments con IA    â”‚                              â”‚
â”‚                        â”‚  â€¢ Actualizar status en BD       â”‚                              â”‚
â”‚                        â”‚                                  â”‚                              â”‚
â”‚                        â”‚  IntegraciÃ³n:                    â”‚                              â”‚
â”‚                        â”‚  â€¢ OpenAI GPT-4                  â”‚                              â”‚
â”‚                        â”‚  â€¢ AWS S3 (lectura archivos)     â”‚                              â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              CAPA DE PERSISTENCIA                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚    ğŸ˜ PostgreSQL      â”‚ â”‚    ğŸƒ MongoDB         â”‚ â”‚    ğŸ”´ Redis          â”‚            â”‚
â”‚   â”‚                       â”‚ â”‚                       â”‚ â”‚    (Opcional)        â”‚            â”‚
â”‚   â”‚  Tablas:              â”‚ â”‚  Collections:         â”‚ â”‚                      â”‚            â”‚
â”‚   â”‚  â€¢ users              â”‚ â”‚  â€¢ material_assessmentâ”‚ â”‚  Uso:                â”‚            â”‚
â”‚   â”‚  â€¢ schools            â”‚ â”‚  â€¢ material_summary   â”‚ â”‚  â€¢ Cache de sesiones â”‚            â”‚
â”‚   â”‚  â€¢ academic_units     â”‚ â”‚  â€¢ material_event     â”‚ â”‚  â€¢ Rate limiting     â”‚            â”‚
â”‚   â”‚  â€¢ memberships        â”‚ â”‚                       â”‚ â”‚  â€¢ Cache de queries  â”‚            â”‚
â”‚   â”‚  â€¢ materials          â”‚ â”‚  PropÃ³sito:           â”‚ â”‚                      â”‚            â”‚
â”‚   â”‚  â€¢ assessment         â”‚ â”‚  Documentos grandes   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚   â”‚  â€¢ assessment_attempt â”‚ â”‚  y flexibles (JSON)   â”‚                                     â”‚
â”‚   â”‚  â€¢ assessment_answers â”‚ â”‚                       â”‚                                     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            SERVICIOS EXTERNOS                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚   â”‚      â˜ï¸ AWS S3        â”‚ â”‚     ğŸ§  OpenAI API     â”‚                                     â”‚
â”‚   â”‚                       â”‚ â”‚                       â”‚                                     â”‚
â”‚   â”‚  Almacena:            â”‚ â”‚  Genera:              â”‚                                     â”‚
â”‚   â”‚  â€¢ PDFs de materiales â”‚ â”‚  â€¢ ResÃºmenes          â”‚                                     â”‚
â”‚   â”‚  â€¢ ImÃ¡genes           â”‚ â”‚  â€¢ Assessments        â”‚                                     â”‚
â”‚   â”‚  â€¢ Documentos         â”‚ â”‚  â€¢ Key points         â”‚                                     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Flujos de Datos Principales

### 1. Flujo: Subida de Material

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Teacher â”‚â”€â”€â”€â”€â–¶â”‚ api-mobileâ”‚â”€â”€â”€â”€â–¶â”‚  AWS S3 â”‚     â”‚ RabbitMQ â”‚â”€â”€â”€â”€â–¶â”‚ Worker â”‚
â”‚         â”‚     â”‚           â”‚â”€â”€â”€â”€â–¶â”‚         â”‚     â”‚          â”‚     â”‚        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                      â”‚                                                 â”‚
                      â”‚                                                 â”‚
                      â–¼                                                 â–¼
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚ PostgreSQL â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  MongoDB  â”‚
               â”‚(material)  â”‚                                    â”‚(assessmentâ”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚ summary)  â”‚
                                                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Pasos:**
1. **Teacher** sube archivo PDF desde app mÃ³vil
2. **api-mobile** sube archivo a **S3** y crea registro en **PostgreSQL** (status: `uploaded`)
3. **api-mobile** publica evento `material.uploaded` a **RabbitMQ**
4. **Worker** consume evento, descarga PDF de S3
5. **Worker** extrae texto y genera resumen/assessment con **OpenAI**
6. **Worker** guarda resultados en **MongoDB**
7. **Worker** actualiza status en **PostgreSQL** (status: `ready`)
8. **Worker** publica evento `assessment.generated`

---

### 2. Flujo: Estudiante Resuelve Assessment

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Student â”‚â”€â”€â”€â”€â–¶â”‚ api-mobileâ”‚â”€â”€â”€â”€â–¶â”‚ PostgreSQL â”‚â”€â”€â”€â”€â–¶â”‚  MongoDB  â”‚
â”‚         â”‚â—€â”€â”€â”€â”€â”‚           â”‚â—€â”€â”€â”€â”€â”‚            â”‚â—€â”€â”€â”€â”€â”‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Pasos:**
1. **Student** solicita assessment disponible
2. **api-mobile** consulta **PostgreSQL** para metadata
3. **api-mobile** consulta **MongoDB** para preguntas completas
4. **Student** responde preguntas
5. **api-mobile** guarda intento en **PostgreSQL** (`assessment_attempt`)
6. **api-mobile** guarda respuestas en **PostgreSQL** (`assessment_attempt_answer`)
7. **api-mobile** calcula score y actualiza intento

---

### 3. Flujo: Administrador Matricula Estudiante

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Admin â”‚â”€â”€â”€â”€â–¶â”‚api-administracionâ”‚â”€â”€â”€â”€â–¶â”‚ PostgreSQL â”‚     â”‚ RabbitMQ â”‚
â”‚       â”‚     â”‚                  â”‚â”€â”€â”€â”€â–¶â”‚            â”‚â”€â”€â”€â”€â–¶â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                                                               â”‚
                                                               â–¼
                                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                        â”‚ api-mobileâ”‚
                                                        â”‚ (consume) â”‚
                                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Pasos:**
1. **Admin** matricula estudiante en unidad acadÃ©mica
2. **api-administracion** crea `Membership` en **PostgreSQL**
3. **api-administracion** publica evento `student.enrolled`
4. **api-mobile** consume evento y actualiza cache/notificaciones

---

## ğŸ¯ Principios de DiseÃ±o

### SeparaciÃ³n de Responsabilidades

| Base de Datos | Tipo de Datos | RazÃ³n |
|---------------|---------------|-------|
| **PostgreSQL** | Estructurado, relacional | Transacciones ACID, queries SQL, constraints |
| **MongoDB** | Semi-estructurado, documentos | Flexibilidad, documentos grandes, arrays anidados |

### Event-Driven Architecture

- **Desacoplamiento:** APIs no esperan respuesta del worker
- **Escalabilidad:** MÃºltiples workers pueden procesar en paralelo
- **Resiliencia:** Eventos persisten en RabbitMQ si worker falla
- **Trazabilidad:** Cada evento tiene `event_id` Ãºnico

### Consistencia Eventual

```
PostgreSQL (metadata)  â”€â”€â”¬â”€â”€  MongoDB (contenido)
         â”‚               â”‚
         â”‚  async sync   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

El sistema acepta **consistencia eventual** entre PostgreSQL y MongoDB:
- PostgreSQL es la fuente de verdad para **metadata**
- MongoDB es la fuente de verdad para **contenido generado**
- El campo `mongo_document_id` en PostgreSQL mantiene la referencia

---

## ğŸ”’ Seguridad

### AutenticaciÃ³n
- **JWT** con access token (15min) y refresh token (7 dÃ­as)
- Tokens almacenados en Redis para blacklist

### AutorizaciÃ³n
- **RBAC** (Role-Based Access Control)
- Roles: `admin`, `teacher`, `student`, `guardian`, `coordinator`

### Datos Sensibles
- Passwords hasheados con **bcrypt**
- API keys en variables de entorno
- ComunicaciÃ³n HTTPS en producciÃ³n

---

## ğŸ“Š Escalabilidad

```
                    Load Balancer
                          â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚              â”‚              â”‚
           â–¼              â–¼              â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚api-mobileâ”‚   â”‚api-mobileâ”‚   â”‚api-mobileâ”‚
      â”‚ replica 1â”‚   â”‚ replica 2â”‚   â”‚ replica 3â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚              â”‚              â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
                    â”‚ RabbitMQ  â”‚
                    â”‚ (cluster) â”‚
                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                          â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚              â”‚              â”‚
           â–¼              â–¼              â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ worker  â”‚   â”‚ worker  â”‚   â”‚ worker  â”‚
      â”‚    1    â”‚   â”‚    2    â”‚   â”‚    3    â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **APIs:** Escalan horizontalmente (stateless)
- **Workers:** Escalan segÃºn carga de procesamiento
- **Bases de datos:** RÃ©plicas de lectura, sharding si necesario

---

## ğŸ”„ Ambientes

| Ambiente | PropÃ³sito | Servicios |
|----------|-----------|-----------|
| **local** | Desarrollo | Docker Compose local |
| **dev** | Testing/CI | AWS ECS/Fargate |
| **staging** | Pre-producciÃ³n | AWS ECS/Fargate |
| **prod** | ProducciÃ³n | AWS ECS/Fargate + RDS + DocumentDB |

---

**Ãšltima actualizaciÃ³n:** Diciembre 2024
